webpackJsonp([3],{Hguv:function(t,e,a){"use strict";var n=a("Cg+j"),i=a.n(n);function s(t){var e=t||{},a=e.hostname,n=e.port,i=(e.timeout,e.keepAlive,e.cleanSession,e.ssl,e.userName),s=e.password;e.path;this.hostname=a||"www.ai0626.top",this.port=n||8084,this.options={clean:!0,connectTimeout:2e3,reconnectPeriod:500,clientId:"clientId-zwt6666",username:i||"admin",password:s||"123456",path:"/mqtt"},this.connectUrl="wss://"+this.hostname+":"+this.port}s.prototype.connect=function(t,e,a){try{this.client=i.a.connect(this.connectUrl,this.options)}catch(t){console.log("mqtt.connect error",t)}return this.client.on("connect",function(){return t()}),this.client.on("error",function(){return e()}),this.client.on("timeout",function(){console.log("....")}),this.client.on("message",function(t,e){return a(t,e.toString())}),console.log(this.client),this.client},s.prototype.disconnect=function(){this.client&&(this.client.end(),this.client=null)}},lVX6:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("Hguv");var n=a("Cg+j"),i=a.n(n),s=a("p3mN"),o={connectTimeout:4e4,clientId:"bbbbmonitor_"+parseInt(100*Math.random()+800,10),keepAliveInterval:10,username:s.g,password:s.c,clean:!0},l={data:function(){return{data:[],datas:[],datass:[],datasss:[],datas3:[],datas4:[],datas5:[],myChart:{},myChart2:{},msg:[],dd:"",aa:{mq7:"",mq2:"",mq135:""},client:{connected:!1}}},mounted:function(){var t=this;this.mqttMSG(),console.log("start"),this.$nextTick(function(){t.drawChart(),t.timer=setInterval(function(){t.data.push(t.$moment(t.date).format("hh:mm:ss")),t.datas.push(t.aa.mq7),t.datass.push(t.aa.mq2),t.datasss.push(t.aa.mq135),t.datas3.push(t.aa.mq7),t.datas4.push(t.aa.mq2),t.datas5.push(t.aa.mq135),t.data.length>1&&(t.datas3.splice(0,1),t.datas4.splice(0,1),t.datas5.splice(0,1)),t.data.length>5&&(t.data.splice(0,1),t.datas.splice(0,1),t.datass.splice(0,1),t.datasss.splice(0,1));var e=t.myChart.getOption();e.xAxis[0].data=t.data,e.series[0].data=t.datas,e.series[1].data=t.datass,e.series[2].data=t.datasss,e.series[3].data[0].value=t.datas3,e.series[4].data[0].value=t.datas4,e.series[5].data[0].value=t.datas5,console.log("开始打印:"),console.log("mq7:"+e.series[4].data[0].value),console.log("mq2:"+e.series[4].data[0].value),console.log("mq135:"+e.series[5].data[0].value),t.myChart.setOption(e),t.$forceUpdate()},2e3)})},destroyed:function(){clearInterval(this.timer),this.client.end(),console.log("stop-MQTT-connect")},methods:{drawChart:function(){this.myChart=this.$echarts.init(document.getElementById("line")),this.myChart.setOption({title:{text:"MQ系列传感器实时图"},tooltip:{trigger:"axis"},grid:{containLabel:!0,top:"55%"},toolbox:{top:"50%",left:"right",show:!0,feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{}}},legend:{data:["一氧化碳浓度","烟雾浓度","有害气体浓度"],right:"center",bottom:"50%"},xAxis:{type:"category",data:[]},yAxis:[{name:"数值",type:"value",max:100,fontSize:20}],series:[{name:"一氧化碳浓度",type:"line",lineStyle:{width:1},data:this.datas,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Avg"}]}},{name:"烟雾浓度",type:"line",lineStyle:{width:1},data:this.datass,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Avg"}]}},{name:"有害气体浓度",type:"line",lineStyle:{width:1},data:this.datasss,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Avg"}]}},{radius:"25%",name:"一氧化碳浓度",type:"gauge",center:["18%","30%"],startAngle:200,endAngle:-20,min:0,max:60,splitNumber:6,itemStyle:{color:"#5470c6"},progress:{show:!0,width:30},pointer:{show:!1},axisLine:{lineStyle:{width:30}},axisTick:{distance:-45,splitNumber:4,lineStyle:{width:2,color:"#999"}},splitLine:{distance:-42,length:10,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:-5,color:"#999",fontSize:10},anchor:{show:!1},title:{show:!0,offsetCenter:["0%","50%"],fontSize:20,color:"#5470c6"},detail:{valueAnimation:!0,width:"60%",lineHeight:40,borderRadius:8,offsetCenter:[0,"-15%"],fontSize:26,fontWeight:"bolder",formatter:"{value}",color:"#5470c6"},data:[{value:this.datas3,name:"一氧化碳浓度"}]},{radius:"25%",name:"烟雾浓度",type:"gauge",center:["50%","30%"],startAngle:200,endAngle:-20,min:0,max:60,splitNumber:6,itemStyle:{color:"#91cc75"},progress:{show:!0,width:30},pointer:{show:!1},axisLine:{lineStyle:{width:30}},axisTick:{distance:-45,splitNumber:4,lineStyle:{width:2,color:"#999"}},splitLine:{distance:-42,length:10,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:-5,color:"#999",fontSize:10},anchor:{show:!1},title:{show:!0,offsetCenter:["0%","50%"],fontSize:20,color:"#91cc75"},detail:{valueAnimation:!0,width:"60%",lineHeight:40,borderRadius:8,offsetCenter:[0,"-15%"],fontSize:26,fontWeight:"bolder",formatter:"{value}",color:"#91cc75"},data:[{value:this.datas4,name:"烟雾浓度"}]},{radius:"25%",name:"有害气体浓度",type:"gauge",center:["82%","30%"],startAngle:200,endAngle:-20,min:0,max:60,splitNumber:6,itemStyle:{color:"#fac858"},progress:{show:!0,width:30},pointer:{show:!1},axisLine:{lineStyle:{width:30}},axisTick:{distance:-45,splitNumber:4,lineStyle:{width:2,color:"#999"}},splitLine:{distance:-42,length:10,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:-3,color:"#999",fontSize:10},anchor:{show:!1},title:{show:!0,offsetCenter:["0%","50%"],fontSize:20,color:"#fac858"},detail:{valueAnimation:!0,width:"60%",lineHeight:40,borderRadius:8,offsetCenter:[0,"-15%"],fontSize:26,fontWeight:"bolder",formatter:"{value}",color:"#fac858"},data:[{value:this.datas5,name:"有害气体浓度"}]}]})},change:function(){this.$router.push({path:"/monitor2"})},mqttMSG:function(){var t=this;this.client=i.a.connect(s.d,o),this.client.on("connect",function(e){console.log("连接成功:"),t.client.subscribe("zwt/test",{qos:0},function(t){t?console.log("订阅失败"):console.log("订阅成功")})}),this.client.on("message",function(e,a){console.log("收到来自",e,"的消息",a.toString()),t.msg=a.toString(),t.dd=JSON.parse(t.msg),t.aa.mq7=t.dd.mq7,t.aa.mq2=t.dd.mq2,t.aa.mq135=t.dd.mq135,console.log(t.aa.mq7),console.log(t.aa.mq2),console.log(t.aa.mq135)}),this.client.on("reconnect",function(t){console.log("正在重连:",t)}),this.client.on("error",function(t){console.log("连接失败:",t)})}}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"top"},[e("div",{staticStyle:{width:"100%",height:"700px","margin-top":"20px"},attrs:{id:"line"}}),this._v(" "),e("el-col",{attrs:{span:24}},[e("el-button",{on:{click:this.change}},[this._v("切换")])],1)],1)},staticRenderFns:[]};var c=a("VU/8")(l,r,!1,function(t){a("q7cw")},"data-v-d371655a",null);e.default=c.exports},q7cw:function(t,e){}});
//# sourceMappingURL=3.5d37ee0f63495f882111.js.map