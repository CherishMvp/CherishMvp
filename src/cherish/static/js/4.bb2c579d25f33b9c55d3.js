webpackJsonp([4],{Hguv:function(t,e,n){"use strict";var a=n("Cg+j"),i=n.n(a);function o(t){var e=t||{},n=e.hostname,a=e.port,i=(e.timeout,e.keepAlive,e.cleanSession,e.ssl,e.userName),o=e.password;e.path;this.hostname=n||"www.ai0626.top",this.port=a||8084,this.options={clean:!0,connectTimeout:2e3,reconnectPeriod:500,clientId:"clientId-zwt6666",username:i||"admin",password:o||"123456",path:"/mqtt"},this.connectUrl="wss://"+this.hostname+":"+this.port}o.prototype.connect=function(t,e,n){try{this.client=i.a.connect(this.connectUrl,this.options)}catch(t){console.log("mqtt.connect error",t)}return this.client.on("connect",function(){return t()}),this.client.on("error",function(){return e()}),this.client.on("timeout",function(){console.log("....")}),this.client.on("message",function(t,e){return n(t,e.toString())}),console.log(this.client),this.client},o.prototype.disconnect=function(){this.client&&(this.client.end(),this.client=null)}},ZezX:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("Hguv");var a=n("Cg+j"),i=n.n(a),o=n("p3mN"),s={connectTimeout:4e4,clientId:"hhhhhmonitor_"+parseInt(100*Math.random()+800,10),keepAliveInterval:10,username:o.e,password:o.a,clean:!0},l={data:function(){return{data:[],datas:[],datass:[],datas3:[],datas4:[],myChart:{},myChart2:{},msg:[],dd:"",temp:"",humi:"",aa:{temp:"",humi:""},client:{connected:!1}}},mounted:function(){var t=this;this.mqttMSG(),console.log("start"),this.$nextTick(function(){t.drawChart(),t.timer=setInterval(function(){t.data.push(t.$moment(t.date).format("hh:mm:ss")),t.datas.push(t.aa.temp),t.datass.push(t.aa.humi),t.datas3.push(t.aa.temp),t.datas4.push(t.aa.humi),t.data.length>1&&(t.datas3.splice(0,1),t.datas4.splice(0,1)),t.data.length>5&&(t.data.splice(0,1),t.datas.splice(0,1),t.datass.splice(0,1));var e=t.myChart.getOption();e.xAxis[0].data=t.data,e.series[0].data=t.datas,e.series[1].data=t.datass,e.series[2].data[0].value=t.datas3,e.series[3].data[0].value=t.datas4,console.log("开始打印:"),console.log("temp:"+e.series[2].data[0].value),console.log("humi:"+e.series[3].data[0].value),t.myChart.setOption(e),t.$forceUpdate()},2e3)})},destroyed:function(){clearInterval(this.timer),this.client.end(),console.log("stop-MQTT-connect")},methods:{drawChart:function(){this.myChart=this.$echarts.init(document.getElementById("line")),this.myChart.setOption({title:{text:"温湿度实时图"},tooltip:{trigger:"axis"},grid:{containLabel:!0,top:"55%"},toolbox:{top:"50%",left:"right",show:!0,feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{}}},legend:{data:["温度","湿度"],right:"center",bottom:"50%"},xAxis:{type:"category",data:[]},yAxis:[{name:"数值",type:"value",max:100}],series:[{name:"温度",type:"line",lineStyle:{width:1},data:this.datas,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Avg"}]}},{name:"湿度",type:"line",lineStyle:{width:1},data:this.datass,markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]},markLine:{data:[{type:"average",name:"Avg"}]}},{radius:"30%",name:"温度",type:"gauge",center:["25%","30%"],startAngle:200,endAngle:-20,min:0,max:60,splitNumber:6,itemStyle:{color:"#fd6e1f"},progress:{show:!0,width:30},pointer:{show:!1},axisLine:{lineStyle:{width:30}},axisTick:{distance:-45,splitNumber:4,lineStyle:{width:2,color:"#999"}},splitLine:{distance:-50,length:10,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:-5,color:"#999",fontSize:14},anchor:{show:!1},title:{show:!0,offsetCenter:["0%","50%"],fontSize:30,color:"#6dff3b"},detail:{valueAnimation:!0,width:"60%",lineHeight:40,borderRadius:8,offsetCenter:[0,"-15%"],fontSize:30,fontWeight:"bolder",formatter:"{value} °C",color:"#6dff3b"},data:[{value:this.datas3,name:"温度"}]},{radius:"30%",name:"湿度",type:"gauge",center:["75%","30%"],startAngle:200,endAngle:-20,min:0,max:90,splitNumber:9,itemStyle:{color:"#4169E1"},progress:{show:!0,width:30},pointer:{show:!1},axisLine:{lineStyle:{width:30}},axisTick:{distance:-45,splitNumber:4,lineStyle:{width:2,color:"#999"}},splitLine:{distance:-50,length:10,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:-5,color:"#999",fontSize:14},anchor:{show:!1},title:{show:!0,offsetCenter:["0%","50%"],fontSize:30,color:"#6dff3b"},detail:{valueAnimation:!0,width:"60%",lineHeight:40,borderRadius:8,offsetCenter:[0,"-15%"],fontSize:30,fontWeight:"bolder",formatter:"{value} %",color:"#6dff3b"},data:[{value:this.datas4,name:"湿度"}]}]})},change:function(){this.$router.push({path:"/monitor2"})},mqttMSG:function(){var t=this;this.client=i.a.connect(o.d,s),this.client.on("connect",function(e){console.log("连接成功:"),t.client.subscribe("zwt/test",{qos:0},function(t){t?console.log("订阅失败"):console.log("订阅成功")})}),this.client.on("message",function(e,n){console.log("收到来自",e,"的消息",n.toString()),t.msg=n.toString(),t.dd=JSON.parse(t.msg),t.aa.mq7=t.dd.mq7,t.aa.mq2=t.dd.mq2,t.aa.mq135=t.dd.mq135,t.aa.temp=t.dd.temp,t.aa.humi=t.dd.humi,console.log(t.aa.mq7),console.log(t.aa.mq2),console.log(t.aa.mq135),console.log(t.temp),console.log(t.humi)}),this.client.on("reconnect",function(t){console.log("正在重连:",t)}),this.client.on("error",function(t){console.log("连接失败:",t)})}}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"top"},[e("div",{staticStyle:{width:"100%",height:"700px","margin-top":"20px"},attrs:{id:"line"}}),this._v(" "),e("el-col",{attrs:{span:24}},[e("el-button",{on:{click:this.change}},[this._v("切换")])],1)],1)},staticRenderFns:[]};var c=n("VU/8")(l,r,!1,function(t){n("law8")},"data-v-16477c42",null);e.default=c.exports},law8:function(t,e){}});
//# sourceMappingURL=4.bb2c579d25f33b9c55d3.js.map